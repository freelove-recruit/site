チャットボット管理画面改善計画書
📋 現状の問題点
1. タイトル・文言の問題

「質問・回答」「自動文章」→ 機能が分からない
「質問タイトルを入力してください」→ 実際はセクション名
プレースホルダーが適切でない

2. 選択肢タイプの問題

「チャット会話」に「自動文章用」タイプが表示される
機能の境界が曖昧

3. 実装の問題

addSelection以外の更新系関数がfetchChatItems()を呼んでバグる可能性
段落が消える現象（修正済み）

4. 管理画面とchatbot.tsxの乖離

管理画面で設定してもchatbot.tsxに反映されない
chatbot.tsxはハードコード、管理画面はSupabase

🎯 解決方針：段階的アプローチ
フェーズ1：基本問題の解決
1.1 タイトル・文言修正
修正前：
- 質問・回答 → チャット会話
- 自動文章 → 応募文生成
- 「質問タイトルを入力してください」

修正後：
- チャット会話（ユーザーが選択→Bot即座に返答）
- 応募文生成（複数選択を組み合わせて文章作成）
- 適切なプレースホルダー設定
1.2 選択肢タイプの整理
チャット会話の選択肢：
- 通常選択肢
- 入力ボックス  
- プルダウン
- リンクボタン
（自動文章用は除外）

応募文生成の選択肢：
- 自動文章用のみ
（または固定で選択肢なし）
1.3 他の更新系関数のSupabase対応

updateSelection
deleteSelection
addResponsePattern
updateResponsePattern
deleteResponsePattern

全てfetchChatItems()削除→ローカル状態更新のみ
フェーズ2：グループ機能追加
2.1 新規作成モーダル拡張
新規作成選択肢：
- グループを作成
- チャット会話を作成
- 応募文生成を作成
2.2 階層構造実装
▼ グループ1: 初期不安選択肢
  ├ チャット会話: 週○日について
  ├ チャット会話: 面接について
  └ [チャット会話追加]

▼ グループ2: その他選択肢  
  ├ チャット会話: 未経験について
  └ [チャット会話追加]

▼ チャット会話: 名前入力（グループ外）
▼ 応募文生成: 基本テンプレート（グループ外）
2.3 chatbot.tsxとの対応

グループ1：最初の4選択肢
グループ2：「特にない」選択後の6選択肢
グループ外：個別フロー（名前入力、年代選択等）

🔧 技術実装詳細
応答パターン仕様

デフォルト3つ（+-ボタンで増減）
表示方式選択：

段落分割返信（入力中効果あり）
一括返信（まとめて表示）



データベース対応

現状のSupabaseテーブル活用
グループ管理用テーブル追加検討
既存データとの互換性維持

chatbot.tsx連携方針

フェーズ1完了後に検討
ハードコード→Supabase参照への移行
動的フロー生成機能

⏰ 実装順序
優先度1（即座に実装）

タイトル・プレースホルダー修正
選択肢タイプ整理
更新系関数のfetchChatItems()削除

優先度2（フェーズ1完了後）

グループ作成機能
階層表示UI
グループ内チャット会話追加

優先度3（将来実装）

chatbot.tsxとの完全連携
動的フロー生成
プレビュー機能

📝 メモ

現状の管理画面構造は基本的に維持
グループはオプション機能（グループなしも可）
段階的実装でリスク最小化
実用性を重視した機能優先順位


作成日： 2025年8月27日
ステータス： フェーズ1実装準備完了