# 管理画面TOPタブ改修 完全引継書

## 📋 改修の目的
チャットボット管理機能を削除し、応募管理に特化したシンプルで実用的な管理画面に変更する。

---

## 🔧 実施済み作業

### **1. チャットボットタブの完全削除**
- **対象ファイル**: `pages/admin/index.tsx`
- **削除内容**: チャットボットタブボタン（82-95行目）とその関連処理
- **理由**: UI複雑すぎ、Supabase連携未完成、実用性が低い

---

## 🎯 新しいTOPタブの設計仕様

### **表示内容（上から順番）**

#### **1. 応募履歴テーブル**
```
応募履歴一覧
┌─────────────────────────────────────────┐
│ 日付・時間    │ 応募方法 │ 応募者名      │
├─────────────────────────────────────────┤
│ 2024/12/20 14:30 │ LINE   │ 田中太郎     │
│ 2024/12/20 09:15 │ メール  │ 佐藤花子     │  
│ 2024/12/19 16:45 │ 電話   │ （電話応募）   │
└─────────────────────────────────────────┘
```
- **クリック機能**: LINE/メール応募者の行をクリック→モーダルで詳細情報表示
- **詳細情報**: 名前、年代、働き方、応募理由、応募文、面接希望時間

#### **2. 応募手段別集計**
```
応募方法別統計
LINE: 5件 / メール: 3件 / 電話: 2件
```

#### **3. カレンダー表示**
```
12月のカレンダー
各日付に応募件数を表示（LINE+メール+電話の合計）
```

---

## 🗃️ データベース設計

### **新規テーブル: chat_applications**
```sql
CREATE TABLE chat_applications (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  contact_method text NOT NULL, -- 'LINE', 'メール', '電話'
  name text,                    -- 電話の場合はNULL
  age text,                     -- 電話の場合はNULL  
  work_style text,              -- 電話の場合はNULL
  reason text,                  -- 電話の場合はNULL
  application_text text,        -- 電話の場合はNULL
  interview_time text,          -- 電話の場合はNULL
  created_at timestamp DEFAULT now()
);
```

### **応募方法別のデータ保存パターン**

#### **電話応募**
- **保存タイミング**: 電話確認選択時
- **保存データ**: `contact_method: '電話'` + `created_at` のみ
- **詳細情報**: なし（電話で直接聞く）

#### **LINE/メール応募**
- **保存タイミング**: 黒枠コピー表示後、各ボタンクリック時
- **保存データ**: 全項目（名前、年代、働き方、応募理由、応募文、面接時間、応募方法、日時）

---

## 🔄 実装手順

### **Phase 1: 管理画面UI作成**
1. **entries.tsxの修正**
   - 円グラフ削除
   - 応募履歴テーブル作成（モックデータで表示確認）
   - 集計数値表示エリア作成
   - カレンダー表示エリア作成

### **Phase 2: Supabaseテーブル作成**
1. **テーブル作成**: 上記SQL実行
2. **モックデータ投入**: テスト用データ数件作成

### **Phase 3: データ連携**
1. **entries.tsx**: Supabaseからデータ取得・表示
2. **chatbot.tsx**: 応募データ保存処理追加

---

## 📂 修正対象ファイル

### **確実に修正が必要**
- `pages/admin/entries.tsx` - TOPタブのメインファイル
- `pages/chatbot.tsx` - 応募データ保存処理追加

### **確認が必要**
- `pages/admin/index.tsx` - チャットボットタブ削除済み
- Supabaseテーブル作成

---

## 🚨 重要な設計方針

### **黒枠コピー内容について**
- **含む**: 名前、年代、働き方、応募理由、応募文、面接希望時間
- **含まない**: 応募方法、応募日時
- **理由**: 応募者が自分用にコピーするもの、管理情報は不要

### **応募方法の記録について**
- 黒枠には表示せず、Supabaseに別途記録
- 管理画面でのみ表示・集計に使用

### **電話応募の扱い**
- 詳細情報なしで「応募があった」記録のみ
- 個人情報は電話で直接聞く運用

---

## 🎯 完成後の効果

1. **シンプルな運用**: 動画管理と応募管理のみに特化
2. **実用性向上**: 他の求人サイトと同レベルの応募管理
3. **メンテナンス性**: 複雑なチャットボット設定が不要

---

**作成日**: 2025年9月10日  
**ステータス**: Phase 1開始準備完了  
**次回作業**: entries.tsxファイルの確認・修正から開始