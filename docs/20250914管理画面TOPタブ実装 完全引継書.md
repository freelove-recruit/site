管理画面TOPタブ 応募データ分析機能 実装引継書
📋 プロジェクト概要
目的
チャットボット応募データをSupabaseに保存し、管理画面TOPタブで分析・表示する機能を実装する
現状

管理画面TOPタブはモックデータ表示
チャットボットは完全動作するが、データ保存機能なし
Supabaseテーブル未作成


🗃️ データベース設計
テーブル名: chat_applications
sqlCREATE TABLE chat_applications (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  name text,
  age text,
  work_style text,
  reason text,
  application_text text,
  interview_time text,
  contact_method text, -- 'LINE', 'メール', '電話'
  created_at timestamp DEFAULT now()
);
データ保存パターン
電話応募

保存タイミング: 電話確認選択時
保存データ: contact_method: '電話' + created_at のみ
詳細情報: なし（電話で直接聞く）

LINE/メール応募

保存タイミング: 黒枠表示後、各ボタンクリック時
保存データ: 全項目（名前、年代、働き方、応募理由、応募文、面接時間、応募方法、日時）


🎯 管理画面表示仕様
1. 応募方法別集計
LINE: X件 / メール: Y件 / 電話: Z件 （2025年9月）
2. 応募履歴テーブル
日付・時間応募方法応募者名09/05 23:30LINE田中太郎09/05 18:15メール佐藤花子09/05 01:45電話（電話応募）
3. カレンダー表示

月別表示（前後月移動可能）
各日付に応募件数を表示
件数クリックで該当日の応募履歴表示

4. 応募詳細モーダル
LINE/メール応募者クリック時に表示：

お名前
年代
働き方
応募理由
面接希望時間
応募方法
応募日時
応募文


🔄 実装手順
Phase 1: Supabaseテーブル作成

Supabase管理画面でテーブル作成
権限設定（Unrestricted）
テスト用モックデータ投入

Phase 2: entries.tsx修正

サンプルデータ削除
Supabaseからのデータ取得処理追加
集計ロジック実装
カレンダー連動機能実装

Phase 3: chatbot.tsx修正

電話選択時の保存処理追加
黒枠生成時の保存処理追加
LINE/メールボタンクリック時の保存処理追加

Phase 4: 動作確認

チャットボット→Supabase保存確認
管理画面でのデータ表示確認
集計数値の正確性確認


💾 容量・コスト検証
想定利用量

応募者: 5人/月
管理画面閲覧: 100回/月

Supabase無料プラン制限

データベース容量: 500MB
転送量: 2GB/月

実際の使用量（試算）

応募データ: 約550KB/月
転送量: 約550KB/月（制限の0.03%）

結論: 無料プランで十分運用可能

📂 修正対象ファイル
Phase 1

Supabaseテーブル作成のみ

Phase 2

pages/admin/entries.tsx - メインファイル

Phase 3

pages/chatbot.tsx - データ保存処理追加


🚨 重要な設計方針
データの扱い

黒枠コピー内容: 応募者用（応募方法・日時含まない）
管理画面データ: 管理者用（応募方法・日時含む）
電話応募: 詳細情報なし、記録のみ

実装方針

一つずつ段階的実装: Phase完了後に次へ
モックデータ完全削除: 実データのみ表示
レスポンシブ対応維持: PC・スマホ両対応


🎯 完成後の効果

リアルタイム応募管理: チャットボット完了と同時にデータ蓄積
データ分析基盤: 応募傾向の把握・改善施策立案
運営効率化: 手動管理からシステム管理への移行
拡張可能性: 今後の機能追加に対応可能な基盤


作成日: 2025年9月14日
ステータス: Phase 1実装準備完了
次回作業: Supabaseテーブル作成から開始

管理画面TOPタブ応募データ分析機能 実装引継書（2025年9月14日）
完了した作業
Phase 1: Supabaseテーブル作成（完了）

chat_applicationsテーブル作成
カラム: id, name, age, work_style, reason, application_text, interview_time, contact_method, created_at
権限設定: RLS無効化（Unrestricted設定）
テストデータ3件投入完了

Phase 2: 管理画面entries.tsx修正（完了）

モックデータ（50-290行目の大量サンプルデータ）完全削除
Supabaseからリアルデータ取得機能が正常動作確認済み
カレンダー・集計・応募履歴テーブル・詳細モーダル全て正常表示

発生した問題点と対策
実装中の問題

手順説明が不明確

問題: 「テストデータを入力してください」→具体的なデータ内容不明
対策: 具体的なフィールド名と値を明示


作業範囲が曖昧

問題: 「修正してください」→開始・終了行が不明
対策: 行番号範囲と具体的修正箇所を明示


省略による混乱

問題: 長いコードを省略→修正範囲が不明
対策: 開始部分と終了部分を明確に表示


文字数制限への配慮不足

問題: 不要な説明で文字数浪費
対策: 簡潔な指示のみに限定



次回実装予定（Phase 3）
目的
チャットボット完了時にSupabaseへ自動保存する機能を実装
実装内容

電話選択時の保存処理

タイミング: 電話確認選択時
保存データ: contact_method: '電話' + created_atのみ


LINE/メール選択時の保存処理

タイミング: 黒枠表示後、各ボタンクリック時
保存データ: 全項目（名前、年代、働き方、応募理由、応募文、面接時間、応募方法、日時）



修正対象ファイル

pages/chatbot.tsx - データ保存処理追加

データ保存仕様

黒枠表示内容: 名前、年代、働き方、応募理由、応募文、面接希望時間
管理側記録: 応募方法、応募日時（created_at自動）
電話応募: 詳細情報なし、記録のみ

実装後の確認事項

チャットボット→Supabase保存動作確認
管理画面でデータ表示確認
テストデータ削除（Supabase Table Editorから手動削除）

技術要件

Supabase INSERT処理
エラーハンドリング
既存チャットボット動作への影響なし


完成度: Phase 2完了（66%）
次回作業: chatbot.tsxファイル確認→データ保存処理実装